# CLeVeR: Multi-modal Contrastive Learning for Vulnerability Code Representation [ACL 2025 Findings, Long Paper]
## :rocket:Highlight
CLeVeR is a novel approach that leverages contrastive learning to generate precise vulnerability code representations under the supervision of vulnerability descriptions. Specifically, CLeVeR introduces an Adapter, a Representation Refinement module, and a Description Simulator to mitigate the challenges of semantic misalignment between code and descriptions, and input data inconsistency between pre-training and fine-tuning stages, respectively. The vulnerability code representation generated by CLeVeR can be used in various vulnerability-related tasks.


![image](https://github.com/yoimiya-nlp/CLeVeR/blob/main/CLEVER_Framework.png)
## :memo:How to Use
### Step 0: Data Collection
First, run ```collect_data.py``` to collect vulnerability and non-vulnerability functions and vulnerability description information from SARD and store them in the ```data``` folder.
```
python collect_data.py
```
Second, use regular expressions to extract and filter the precise functions and descriptions. It is worth mentioning that the code may need slight modifications as the SARD website is updated.
```
python extract_functions.py
```
### Step 1: Preprocessing
Preprocess the dataset ```dataset.jsonl``` and split it into ```dataset_train.pkl``` and ```dataset_test.pkl```.
```
sh preprocess.sh
```
### Step 2: Pre-training
Train the CLeVeR model, remember to set ```--pretrain_code_model_name``` and ```--pretrain_text_model_name``` to the models you want to use on Huggingface.
```
sh train.sh
```
### Step 3-1: Fine-tuning (Linear Probing)
Use linear probing to fine-tune the CLeVeR model, use ```--do_train``` and ```--do_test``` to fine-tune and test CLeVeR's performance for the vulnerability detection task, and use ```--do_train_cls``` and ```--do_test_cls``` for the vulnerability classification task.
```
sh linear_probe_detect.sh
```
### Step 3-2: Zero-shot Inference
Construct different labels into descriptions and perform vulnerability detection and classification by calculating representation similarity,  use ```--do_test``` for the vulnerability detection task and ```--do_test_cls``` for the vulnerability classification task.
```
sh zero_shot_detect.sh
```
## :star:Citation
If you find this repo useful, please cite our paper.
